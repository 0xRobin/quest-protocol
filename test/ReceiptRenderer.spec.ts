import {expect} from 'chai'
import { Contract } from 'ethers';
import {ethers, upgrades} from 'hardhat'

describe('ReceiptRenderer Contract', async () => {
  let ReceiptRenderer: Contract,
  deployedReceiptRenderer: Contract

  const wrappedEthAddress = "0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"
  const tokenId = 100
  const questId = "questid123"
  const totalParticipants = 500
  const claimed = true
  const rewardAmount = ethers.BigNumber.from("100000000000000000")

  beforeEach(async () => {
    ReceiptRenderer = await ethers.getContractFactory('ReceiptRenderer')

    deployedReceiptRenderer = await ReceiptRenderer.deploy()
    await deployedReceiptRenderer.deployed()
  })

  describe('generateTextFields', () => {
    it('generates the correct text fields', async () => {
      let textFields = await deployedReceiptRenderer.generateTextFields(claimed, questId, "0.000000000000001", "WETH");
      expect(textFields).to.equal('<g filter="url(#E)" class="I"><text fill="#0f0f16" xml:space="preserve" style="white-space:pre" font-size="26" font-weight="bold" letter-spacing="0.07em"><tspan y="750" x="325" class="J">CLAIMED</tspan></text></g><g filter="url(#F)" class="H I J L"><text font-size="26" letter-spacing="0em" x="50%" y="615"><tspan>RabbitHole</tspan></text></g><g filter="url(#G)" class="H I J L"><text font-size="39.758" letter-spacing="0.05em" x="50%" y="365">0.000000000000001 WETH</text></g>')
    })
  })

  describe('humanRewardAmount', () => {
    it('generates the reward amount and symbol text', async () => {
      let rewardAmountText = await deployedReceiptRenderer.humanRewardAmount(ethers.BigNumber.from("100000000000000000"), wrappedEthAddress);
      expect(rewardAmountText).to.equal("0.1")
    })
  })

  describe('symbolForAddress', () => {
    it('generates the correct symbol for the address', async () => {
      let symbol = await deployedReceiptRenderer.symbolForAddress(wrappedEthAddress);
      expect(symbol).to.equal("WETH")
    })
  })

  describe('generateTokenURI', () => {
    it('has the correct metadata', async () => {
      let base64encoded = await deployedReceiptRenderer.generateTokenURI(tokenId, questId, totalParticipants, claimed, rewardAmount, wrappedEthAddress);

      let buff = Buffer.from(base64encoded.replace("data:application/json;base64,", ""), 'base64');
      let metadata = buff.toString('ascii');

      let expectedMetada = {
        "name": "RabbitHole.gg Receipt #100",
        "description": "RabbitHole.gg Receipts are used to claim rewards from completed quests.",
        "image": "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iNjQ4IiBoZWlnaHQ9Ijg4OSIgZmlsbD0ibm9uZSI+PHN0eWxlPjwhW0NEQVRBWy5Ce2ZpbGwtcnVsZTpldmVub2RkfS5De2NvbG9yLWludGVycG9sYXRpb24tZmlsdGVyczpzUkdCfS5Ee2Zsb29kLW9wYWNpdHk6MH0uRXtmaWxsLW9wYWNpdHk6LjV9LkZ7c3Ryb2tlOiNhZDg2ZmZ9Lkd7c3Ryb2tlLXdpZHRoOjJ9Lkh7ZmlsbDojZGFlMGZmfS5Je2ZvbnQtZmFtaWx5OkFyaWFsfS5Ke3RleHQtYW5jaG9yOm1pZGRsZX0uS3tzaGFwZS1yZW5kZXJpbmc6Y3Jpc3BFZGdlc30uTHtkb21pbmFudC1iYXNlbGluZTptaWRkbGV9XV0+PC9zdHlsZT48ZyBmaWx0ZXI9InVybCgjQikiPjxwYXRoIGQ9Ik05MS43MzEgNDQuMTk1Yy0yNS45NTcgMC00NyAyMS4wNDMtNDcgNDd2MTE0YzAgMjUuOTU4IDIxLjA0MyA0NyA0NyA0N0gyMjAuMjN2Mzg0SDkxLjczMWMtMjUuOTU3IDAtNDcgMjEuMDQzLTQ3IDQ3djExNGMwIDI1Ljk1OCAyMS4wNDMgNDcgNDcgNDdoNDY1YzI1Ljk1OCAwIDQ3LTIxLjA0MiA0Ny00N3YtMTE0YzAtMjUuOTU3LTIxLjA0Mi00Ny00Ny00N2gtMTI4LjV2LTM4NGgxMjguNWMyNS45NTggMCA0Ny0yMS4wNDIgNDctNDd2LTExNGMwLTI1Ljk1Ny0yMS4wNDItNDctNDctNDdIOTEuNzMxeiIgZmlsbD0iIzBmMGYxNiIgY2xhc3M9IkIiLz48cGF0aCBkPSJNMjIwLjczIDI1Mi4xOTV2LS41aC0uNUg5MS43MzFjLTI1LjY4MSAwLTQ2LjUtMjAuODE4LTQ2LjUtNDYuNXYtMTE0YzAtMjUuNjgxIDIwLjgxOS00Ni41IDQ2LjUtNDYuNWg0NjVjMjUuNjgyIDAgNDYuNSAyMC44MTkgNDYuNSA0Ni41djExNGMwIDI1LjY4Mi0yMC44MTggNDYuNS00Ni41IDQ2LjVoLTEyOC41LS41di41IDM4NCAuNWguNSAxMjguNWMyNS42ODIgMCA0Ni41IDIwLjgxOSA0Ni41IDQ2LjV2MTE0YzAgMjUuNjgyLTIwLjgxOCA0Ni41LTQ2LjUgNDYuNUg5MS43MzFjLTI1LjY4MSAwLTQ2LjUtMjAuODE4LTQ2LjUtNDYuNXYtMTE0YzAtMjUuNjgxIDIwLjgxOS00Ni41IDQ2LjUtNDYuNUgyMjAuMjNoLjV2LS41LTM4NHoiIHN0cm9rZT0iIzIzMjg1NCIvPjwvZz48bWFzayBpZD0iQSIgZmlsbD0iI2ZmZiI+PHBhdGggZD0iTTQ0LjczMSA5MS4xOTVjMC0yNS45NTcgMjEuMDQzLTQ3IDQ3LTQ3aDQ2NWMyNS45NTggMCA0NyAyMS4wNDMgNDcgNDd2MTE0YzAgMjEuNDQ4LTE0LjM2NSAzOS41NC0zNCA0NS4xNzl2Mzg3LjY0MmMxOS42MzUgNS42NCAzNCAyMy43MzIgMzQgNDUuMTc5djExNGMwIDI1Ljk1OC0yMS4wNDIgNDctNDcgNDdIOTEuNzMxYy0yNS45NTcgMC00Ny0yMS4wNDItNDctNDd2LTExNGMwLTIxLjgxIDE0Ljg1Ni00MC4xNSAzNS00NS40NTRWMjUwLjY1Yy0yMC4xNDUtNS4zMDQtMzUtMjMuNjQ1LTM1LTQ1LjQ1NXYtMTE0eiIgY2xhc3M9IkIiLz48L21hc2s+PHBhdGggZD0iTTU2OS43MyAyNTAuMzc0bC0uMjc2LS45NjEtLjcyNC4yMDh2Ljc1M2gxem0wIDM4Ny42NDJoLTF2Ljc1NGwuNzI0LjIwNy4yNzYtLjk2MXptLTQ4OS45OTktLjI3NWwuMjU1Ljk2Ny43NDUtLjE5NnYtLjc3MWgtMXptMC0zODcuMDkxaDF2LS43NzFsLS43NDUtLjE5Ny0uMjU1Ljk2OHptMTItMjA3LjQ1NWMtMjYuNTEgMC00OCAyMS40OS00OCA0OGgyYzAtMjUuNDA1IDIwLjU5NS00NiA0Ni00NnYtMnptNDY1IDBIOTEuNzMxdjJoNDY1di0yem00OCA0OGMwLTI2LjUxLTIxLjQ5LTQ4LTQ4LTQ4djJjMjUuNDA2IDAgNDYgMjAuNTk1IDQ2IDQ2aDJ6bTAgMTE0di0xMTRoLTJ2MTE0aDJ6bS0zNC43MjMgNDYuMTRjMjAuMDUxLTUuNzU5IDM0LjcyMy0yNC4yMzQgMzQuNzIzLTQ2LjE0aC0yYzAgMjAuOTktMTQuMDU5IDM4LjY5OS0zMy4yNzYgNDQuMjE4bC41NTMgMS45MjJ6bS43MjMgMzg2LjY4MVYyNTAuMzc0aC0ydjM4Ny42NDJoMnptMzQgNDUuMTc5YzAtMjEuOTA1LTE0LjY3Mi00MC4zODEtMzQuNzIzLTQ2LjE0bC0uNTUzIDEuOTIyYzE5LjIxNyA1LjUyIDMzLjI3NiAyMy4yMjkgMzMuMjc2IDQ0LjIxOGgyem0wIDExNHYtMTE0aC0ydjExNGgyem0tNDggNDhjMjYuNTEgMCA0OC0yMS40OSA0OC00OGgtMmMwIDI1LjQwNS0yMC41OTQgNDYtNDYgNDZ2MnptLTQ2NC45OTkgMGg0NjV2LTJIOTEuNzMxdjJ6bS00OC00OGMwIDI2LjUxIDIxLjQ5IDQ4IDQ4IDQ4di0yYy0yNS40MDUgMC00Ni0yMC41OTUtNDYtNDZoLTJ6bTAtMTE0djExNGgydi0xMTRoLTJ6bTM1Ljc0NS00Ni40MjFjLTIwLjU3MyA1LjQxNy0zNS43NDUgMjQuMTQ2LTM1Ljc0NSA0Ni40MjFoMmMwLTIxLjM0NCAxNC41MzktMzkuMjk2IDM0LjI1NS00NC40ODdsLS41MDktMS45MzR6bS0uNzQ1LTM4Ni4xMjR2Mzg3LjA5MWgyVjI1MC42NWgtMnptLTM1LTQ1LjQ1NWMwIDIyLjI3NiAxNS4xNzMgNDEuMDA1IDM1Ljc0NSA0Ni40MjJsLjUwOS0xLjkzNWMtMTkuNzE2LTUuMTkxLTM0LjI1NS0yMy4xNDItMzQuMjU1LTQ0LjQ4N2gtMnptMC0xMTR2MTE0aDJ2LTExNGgtMnoiIGZpbGw9IiMyMzI4NTQiIG1hc2s9InVybCgjQSkiLz48ZyBmaWx0ZXI9InVybCgjQykiIGNsYXNzPSJCIEsiPjx1c2UgeGxpbms6aHJlZj0iI00iIGZpbGw9IiMwMDAiIGZpbGwtb3BhY2l0eT0iLjAxIi8+PC9nPjx1c2UgeGxpbms6aHJlZj0iI00iIGZpbGw9IiMwYzBiMGYiIGZpbGwtb3BhY2l0eT0iLjI2IiBjbGFzcz0iQiIvPjxnIHN0eWxlPSJtaXgtYmxlbmQtbW9kZTpjb2xvci1kb2RnZSIgZmlsdGVyPSJ1cmwoI0QpIiBjbGFzcz0iQiBLIj48dXNlIHhsaW5rOmhyZWY9IiNNIiBmaWxsPSJ1cmwoI0gpIiBmaWxsLW9wYWNpdHk9Ii45OSIvPjwvZz48dXNlIHhsaW5rOmhyZWY9IiNOIiBmaWxsPSJ1cmwoI0kpIiBzdHlsZT0ibWl4LWJsZW5kLW1vZGU6Y29sb3ItZG9kZ2UiIGNsYXNzPSJFIi8+PHVzZSB4bGluazpocmVmPSIjTiIgZmlsbD0idXJsKCNKKSIgc3R5bGU9Im1peC1ibGVuZC1tb2RlOmNvbG9yLWRvZGdlIiBjbGFzcz0iRSIvPjx1c2UgeGxpbms6aHJlZj0iI04iIGZpbGw9InVybCgjSykiIHN0eWxlPSJtaXgtYmxlbmQtbW9kZTpjb2xvci1kb2RnZSIgY2xhc3M9IkUiLz48dXNlIHhsaW5rOmhyZWY9IiNOIiBmaWxsPSJ1cmwoI0wpIiBzdHlsZT0ibWl4LWJsZW5kLW1vZGU6Y29sb3ItZG9kZ2UiIGNsYXNzPSJFIi8+PHVzZSB4bGluazpocmVmPSIjTiIgY2xhc3M9IkYgRyIvPjxwYXRoIGQ9Ik04MS40MjUgNjk1LjE5NUg1NjkuMjd2NTguNWwtMzUuNzYgMzcuMTMxLTQ1Mi4wODUuMzY5di05NnoiIGZpbGw9IiNhZDg2ZmYiLz48cGF0aCBkPSJNMzI1LjIzMSAzMTUuMDA5bC0uMDAxLTIzNi44MDJtLTcuNSAyMzYuMjY1Vjk1Ljg5MmwtMTguNS0xOC42OTdtMzMuNSAyMzcuMjc3Vjk1Ljg5MmwxOC41LTE4LjY5N20tNDAuNSAyMzcuNTQ1Vjk5LjQzbC0yMi0yMi4yMzRtNTIgMjM3LjI3N1Y5OS40M2wyMi0yMi4yMzRtLTM2LjUgMzMxLjY2NmwtLjAwMSAxNzAuNTY1bTcuNTAxLTE3MC41NjV2MTUyLjg4bDE4LjUgMTguNjk3bS0zMy41LTE3MS41Nzd2MTUyLjg4bC0xOC41IDE4LjY5N200MC41LTE3MS4yNDJ2MTQ5LjAwN2wyMiAyMi4yMzVtLTUyLTE3MS43NzV2MTQ5LjU0bC0yMiAyMi4yMzVtLTY2LjY4My0yNjYuMjQzSDQyMi42N2wyOS42IDQ3LjUtMjkuNiA0Ny41SDIyMi4wNDdsLTI4Ljc3Ny00Ny41IDI4Ljc3Ny00Ny41em0uMjIzIDI5Ny41YzAtMTcuMzk3IDE0LjEwMy0zMS41IDMxLjUtMzEuNWgxNDBjMTcuMzk3IDAgMzEuNSAxNC4xMDMgMzEuNSAzMS41cy0xNC4xMDMgMzEuNS0zMS41IDMxLjVoLTE0MGMtMTcuMzk3IDAtMzEuNS0xNC4xMDMtMzEuNS0zMS41em0xMDIgODMuNDk5djk1bS0yNDUtOTZoNDg4IiBjbGFzcz0iRiBHIi8+PHBhdGggZD0iTTUwOC4wMjIgMTc4LjM0YzEwLjgwMy00LjMyMyAxOC40NS0xNS4wMjkgMTguNDUtMjcuNTUgMC0xNi4zNDUtMTMuMDI5LTI5LjU5NS0yOS4xMDEtMjkuNTk1cy0yOS4xMDEgMTMuMjUtMjkuMTAxIDI5LjU5NWMwIDEwLjM4NSA1LjI1OSAxOS41MiAxMy4yMTcgMjQuODAyLjU2Ni0xLjAyIDEuNjEyLTEuNzA1IDIuODA5LTEuNzA1LjI2NSAwIC40ODgtLjI0Ny40MjItLjUwNGEyMC40NyAyMC40NyAwIDAgMS0uNjQ0LTUuMTE1YzAtMTAuNjUyIDguMTA1LTE5LjI4NyAxOC4xMDQtMTkuMjg3LjY4NyAwIDEuMjkzLS40NjMgMS41MjItMS4xMTFsLjA1OC0uMTU4Yy40NzEtMS4yNi0uMzE0LTMuMDQzLTEuNjI1LTMuMzQ1LTYuNy0xLjU0NS0xMi4wMTYtNy4wMjItMTMuNjg4LTE0LjAzNi0uMTkyLS44MDUuNzE0LTEuMzQxIDEuMzczLS44MzlsMjYuNDE2IDIwLjA5N2MuMjg3LjIxOC40MjEuNTgzLjM1OC45MzktLjE4MSAxLjAyMS0uMjc2IDIuMDc1LS4yNzYgMy4xNTIgMCAxLjMzNC4xNDYgMi42MzMuNDIgMy44NzguMDc5LjM2MS0uMDQzLjc0Mi0uMzQ4Ljk1MWE4LjI0IDguMjQgMCAwIDEtNC42NjIgMS40NDdjLTEuMzk3IDAtMi43MTYtLjM1MS0zLjg4LS45NzMtLjM0NC0uMTg0LS43NC0uMjU1LTEuMTE5LS4xNjUtLjY1Mi4xNTUtMS4xMTIuNzM4LTEuMTEyIDEuNDA4djEyLjE2OWMwIC41MTYtLjQxOC45MzQtLjkzNC45MzRoLTEuNTA2Yy0uNTA0IDAtLjkxMi0uNC0uOTc4LS44OTktLjU2LTQuMjI5LTMuOTczLTcuNDgzLTguMTAxLTcuNDgzLS4yNjIgMC0uNTIxLjAxMy0uNzc3LjAzOS0uMzA0LjAzLS41MjQuMjk0LS41MjQuNiAwIC4zMzUuMjY0LjYwNy41OTYuNjUzIDMuMzk5LjQ3MSA2LjAyNCAzLjU1MyA2LjAyNCA3LjI4NWE3LjgzIDcuODMgMCAwIDEtLjEzNyAxLjQ2NGMtLjEwMS41MjcuMjc4IDEuMDU5LjgxNSAxLjA1OWguNzYyYS4wMi4wMiAwIDAgMSAuMDIuMDIuMDIuMDIgMCAwIDAgLjAyLjAyaDUuODk0Yy4wNjUgMCAuMTI4LjAyNS4xNzQuMDcxaDBhMTUuNTIgMTUuNTIgMCAwIDEgLjUwOS41MmMuMzUuMzguNDkyLjkxNS41NSAxLjY2MnptLTI3LjQxOS0zMS42NWMtLjQ4OC0uMzg5LS4xOTMtMS4xMjYuNDMxLTEuMTI2aDE2LjYyNmMuNjI0IDAgLjkxOS43MzcuNDMxIDEuMTI2LTIuNDM2IDEuOTQtNS40NjMgMy4wODktOC43NDQgMy4wODlzLTYuMzA5LTEuMTQ5LTguNzQ0LTMuMDg5em0zMS41IDUuMzAzYzAgLjkyMi0uNzA1IDEuNjY5LTEuNTc1IDEuNjY5cy0xLjU3NS0uNzQ3LTEuNTc1LTEuNjY5LjcwNS0xLjY2OSAxLjU3NS0xLjY2OSAxLjU3NS43NDggMS41NzUgMS42Njl6IiBjbGFzcz0iQiBIIi8+PGcgZmlsdGVyPSJ1cmwoI0UpIiBjbGFzcz0iSSI+PHRleHQgZmlsbD0iIzBmMGYxNiIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIgc3R5bGU9IndoaXRlLXNwYWNlOnByZSIgZm9udC1zaXplPSIyNiIgZm9udC13ZWlnaHQ9ImJvbGQiIGxldHRlci1zcGFjaW5nPSIwLjA3ZW0iPjx0c3BhbiB5PSI3NTAiIHg9IjMyNSIgY2xhc3M9IkoiPkNMQUlNRUQ8L3RzcGFuPjwvdGV4dD48L2c+PGcgZmlsdGVyPSJ1cmwoI0YpIiBjbGFzcz0iSCBJIEogTCI+PHRleHQgZm9udC1zaXplPSIyNiIgbGV0dGVyLXNwYWNpbmc9IjBlbSIgeD0iNTAlIiB5PSI2MTUiPjx0c3Bhbj5SYWJiaXRIb2xlPC90c3Bhbj48L3RleHQ+PC9nPjxnIGZpbHRlcj0idXJsKCNHKSIgY2xhc3M9IkggSSBKIEwiPjx0ZXh0IGZvbnQtc2l6ZT0iMzkuNzU4IiBsZXR0ZXItc3BhY2luZz0iMC4wNWVtIiB4PSI1MCUiIHk9IjM2NSI+MC4xIFdFVEg8L3RleHQ+PC9nPjxnIGNsYXNzPSJGIEciPjx1c2UgeGxpbms6aHJlZj0iI08iLz48dXNlIHhsaW5rOmhyZWY9IiNPIiB4PSItMzUzIi8+PHVzZSB4bGluazpocmVmPSIjTyIgeT0iMjU2Ii8+PHVzZSB4bGluazpocmVmPSIjTyIgeD0iLTM1MyIgeT0iMjU2Ii8+PC9nPjxkZWZzPjxmaWx0ZXIgaWQ9IkIiIHg9Ii43MyIgeT0iLjE5NSIgd2lkdGg9IjY0NyIgaGVpZ2h0PSI4ODgiIGZpbHRlclVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgY2xhc3M9IkMiPjxmZUZsb29kIGNsYXNzPSJEIi8+PGZlQmxlbmQgaW49IlNvdXJjZUdyYXBoaWMiLz48ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIyMiIvPjwvZmlsdGVyPjxmaWx0ZXIgaWQ9IkMiIHg9IjEzLjgxNiIgeT0iMTAuMTk1IiB3aWR0aD0iNjIyIiBoZWlnaHQ9Ijg0NyIgZmlsdGVyVW5pdHM9InVzZXJTcGFjZU9uVXNlIiBjbGFzcz0iQyI+PGZlRmxvb2QgcmVzdWx0PSJBIiBjbGFzcz0iRCIvPjxmZUNvbG9yTWF0cml4IGluPSJTb3VyY2VBbHBoYSIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAxMjcgMCIgcmVzdWx0PSJCIi8+PGZlT2Zmc2V0Lz48ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIxIi8+PGZlQ29tcG9zaXRlIGluMj0iQiIgb3BlcmF0b3I9Im91dCIvPjxmZUNvbG9yTWF0cml4IHZhbHVlcz0iMCAwIDAgMCAwLjc1NiAwIDAgMCAwIDAuMjM3NSAwIDAgMCAwIDEgMCAwIDAgMSAwIi8+PGZlQmxlbmQgaW4yPSJBIiByZXN1bHQ9IkMiLz48ZmVDb2xvck1hdHJpeCBpbj0iU291cmNlQWxwaGEiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMTI3IDAiIHJlc3VsdD0iQiIvPjxmZU9mZnNldC8+PGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iMzMiLz48ZmVDb21wb3NpdGUgaW4yPSJCIiBvcGVyYXRvcj0ib3V0Ii8+PGZlQ29sb3JNYXRyaXggdmFsdWVzPSIwIDAgMCAwIDAuNjA5NSAwIDAgMCAwIDAuMTEyNSAwIDAgMCAwIDEgMCAwIDAgMC44MyAwIi8+PGZlQmxlbmQgaW4yPSJDIi8+PGZlQmxlbmQgaW49IlNvdXJjZUdyYXBoaWMiIHJlc3VsdD0iRSIvPjxmZUNvbG9yTWF0cml4IGluPSJTb3VyY2VBbHBoYSIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAxMjcgMCIgcmVzdWx0PSJCIi8+PGZlT2Zmc2V0Lz48ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIxIi8+PGZlQ29tcG9zaXRlIGluMj0iQiIgb3BlcmF0b3I9ImFyaXRobWV0aWMiIGsyPSItMSIgazM9IjEiLz48ZmVDb2xvck1hdHJpeCB2YWx1ZXM9IjAgMCAwIDAgMC42MyAwIDAgMCAwIDAuNTM3NSAwIDAgMCAwIDEgMCAwIDAgMSAwIi8+PGZlQmxlbmQgaW4yPSJFIi8+PC9maWx0ZXI+PGZpbHRlciBpZD0iRCIgeD0iNzUuODE2IiB5PSI3Ni4xOTUiIHdpZHRoPSI0OTgiIGhlaWdodD0iNzIzIiBmaWx0ZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIGNsYXNzPSJDIj48ZmVGbG9vZCByZXN1bHQ9IkEiIGNsYXNzPSJEIi8+PGZlQ29sb3JNYXRyaXggaW49IlNvdXJjZUFscGhhIiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDEyNyAwIiByZXN1bHQ9IkIiLz48ZmVPZmZzZXQgZHk9IjQiLz48ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIyIi8+PGZlQ29tcG9zaXRlIGluMj0iQiIgb3BlcmF0b3I9Im91dCIvPjxmZUNvbG9yTWF0cml4IHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMC4yNSAwIi8+PGZlQmxlbmQgaW4yPSJBIi8+PGZlQmxlbmQgaW49IlNvdXJjZUdyYXBoaWMiLz48L2ZpbHRlcj48ZmlsdGVyIGlkPSJFIiB5PSI2NzUuNTg0IiBoZWlnaHQ9IjEzNi42MTEiIGZpbHRlclVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeD0iMTAwIiB3aWR0aD0iNDUwIiBjbGFzcz0iQyI+PGZlRmxvb2QgcmVzdWx0PSJBIiBjbGFzcz0iRCIvPjxmZUNvbG9yTWF0cml4IGluPSJTb3VyY2VBbHBoYSIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAxMjcgMCIgcmVzdWx0PSJCIi8+PGZlT2Zmc2V0Lz48ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIxLjUiLz48ZmVDb21wb3NpdGUgaW4yPSJCIiBvcGVyYXRvcj0ib3V0Ii8+PGZlQ29sb3JNYXRyaXggdmFsdWVzPSIwIDAgMCAwIDAuOTY2ODY3IDAgMCAwIDAgMC41ODU4MzMgMCAwIDAgMCAxIDAgMCAwIDAuODcgMCIvPjxmZUJsZW5kIGluMj0iQSIgcmVzdWx0PSJDIi8+PGZlQ29sb3JNYXRyaXggaW49IlNvdXJjZUFscGhhIiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDEyNyAwIiByZXN1bHQ9IkIiLz48ZmVPZmZzZXQvPjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjI5LjUiLz48ZmVDb21wb3NpdGUgaW4yPSJCIiBvcGVyYXRvcj0ib3V0Ii8+PGZlQ29sb3JNYXRyaXggdmFsdWVzPSIwIDAgMCAwIDAuNjI0MTY3IDAgMCAwIDAgMC4xNDU4MzMgMCAwIDAgMCAxIDAgMCAwIDAuOTEgMCIvPjxmZUJsZW5kIGluMj0iQyIvPjxmZUJsZW5kIGluPSJTb3VyY2VHcmFwaGljIi8+PC9maWx0ZXI+PGZpbHRlciBpZD0iRiIgeD0iMjAzLjE2NiIgeT0iNTQzLjM4OSIgd2lkdGg9IjI0My42MiIgaGVpZ2h0PSIxMzYuOTE2IiBmaWx0ZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIGNsYXNzPSJDIj48ZmVGbG9vZCByZXN1bHQ9IkEiIGNsYXNzPSJEIi8+PGZlQ29sb3JNYXRyaXggaW49IlNvdXJjZUFscGhhIiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDEyNyAwIiByZXN1bHQ9IkIiLz48ZmVPZmZzZXQvPjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjEuNSIvPjxmZUNvbXBvc2l0ZSBpbjI9IkIiIG9wZXJhdG9yPSJvdXQiLz48ZmVDb2xvck1hdHJpeCB2YWx1ZXM9IjAgMCAwIDAgMC45NjY4NjcgMCAwIDAgMCAwLjU4NTgzMyAwIDAgMCAwIDEgMCAwIDAgMC44NyAwIi8+PGZlQmxlbmQgaW4yPSJBIiByZXN1bHQ9IkMiLz48ZmVDb2xvck1hdHJpeCBpbj0iU291cmNlQWxwaGEiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMTI3IDAiIHJlc3VsdD0iQiIvPjxmZU9mZnNldC8+PGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iMjkuNSIvPjxmZUNvbXBvc2l0ZSBpbjI9IkIiIG9wZXJhdG9yPSJvdXQiLz48ZmVDb2xvck1hdHJpeCB2YWx1ZXM9IjAgMCAwIDAgMC42MjQxNjcgMCAwIDAgMCAwLjE0NTgzMyAwIDAgMCAwIDEgMCAwIDAgMC45MSAwIi8+PGZlQmxlbmQgaW4yPSJDIi8+PGZlQmxlbmQgaW49IlNvdXJjZUdyYXBoaWMiLz48L2ZpbHRlcj48ZmlsdGVyIGlkPSJHIiB4PSIxOTYuODc2IiB5PSIyOTAuNjE5IiB3aWR0aD0iMjQ3LjciIGhlaWdodD0iMTQ3LjA2MiIgZmlsdGVyVW5pdHM9InVzZXJTcGFjZU9uVXNlIiBjbGFzcz0iQyI+PGZlRmxvb2QgcmVzdWx0PSJBIiBjbGFzcz0iRCIvPjxmZUNvbG9yTWF0cml4IGluPSJTb3VyY2VBbHBoYSIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAxMjcgMCIgcmVzdWx0PSJCIi8+PGZlT2Zmc2V0Lz48ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIxLjUiLz48ZmVDb21wb3NpdGUgaW4yPSJCIiBvcGVyYXRvcj0ib3V0Ii8+PGZlQ29sb3JNYXRyaXggdmFsdWVzPSIwIDAgMCAwIDAuOTY2ODY3IDAgMCAwIDAgMC41ODU4MzMgMCAwIDAgMCAxIDAgMCAwIDAuODcgMCIvPjxmZUJsZW5kIGluMj0iQSIgcmVzdWx0PSJDIi8+PGZlQ29sb3JNYXRyaXggaW49IlNvdXJjZUFscGhhIiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDEyNyAwIiByZXN1bHQ9IkIiLz48ZmVPZmZzZXQvPjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjI5LjUiLz48ZmVDb21wb3NpdGUgaW4yPSJCIiBvcGVyYXRvcj0ib3V0Ii8+PGZlQ29sb3JNYXRyaXggdmFsdWVzPSIwIDAgMCAwIDAuNjI0MTY3IDAgMCAwIDAgMC4xNDU4MzMgMCAwIDAgMCAxIDAgMCAwIDAuOTEgMCIvPjxmZUJsZW5kIGluMj0iQyIvPjxmZUJsZW5kIGluPSJTb3VyY2VHcmFwaGljIi8+PC9maWx0ZXI+PHJhZGlhbEdyYWRpZW50IGlkPSJIIiBjeD0iMCIgY3k9IjAiIHI9IjEiIGdyYWRpZW50VHJhbnNmb3JtPSJtYXRyaXgoNzg0LjE4NCwwLDAsNzYxLjE3LDMyNS44MTYsMzgwLjE5NSkiIHhsaW5rOmhyZWY9IiNQIj48c3RvcCBvZmZzZXQ9Ii4wMSIgc3RvcC1jb2xvcj0iI2JkMDBmZiIgc3RvcC1vcGFjaXR5PSIuMzkiLz48c3RvcCBvZmZzZXQ9Ii4xMzUiIHN0b3AtY29sb3I9IiNlYzdiZmYiIHN0b3Atb3BhY2l0eT0iLjIyIi8+PHN0b3Agb2Zmc2V0PSIuMjcxIiBzdG9wLWNvbG9yPSIjZjI1YWZmIiBzdG9wLW9wYWNpdHk9Ii40OCIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzAxMDAzOSIgc3RvcC1vcGFjaXR5PSIuNjkiLz48L3JhZGlhbEdyYWRpZW50PjxyYWRpYWxHcmFkaWVudCBpZD0iSSIgY3g9IjAiIGN5PSIwIiByPSIxIiBncmFkaWVudFRyYW5zZm9ybT0idHJhbnNsYXRlKDMyMC4zMTYgNTcuMTk1Mykgcm90YXRlKDg4LjYyMzgpIHNjYWxlKDMzMy4wOTYgNTc5Ljc2MSkiIHhsaW5rOmhyZWY9IiNQIj48c3RvcCBzdG9wLWNvbG9yPSIjOGYwMGZmIiBzdG9wLW9wYWNpdHk9Ii41MSIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzFjMjMxYiIgc3RvcC1vcGFjaXR5PSIwIi8+PHN0b3Agb2Zmc2V0PSIxIiBzdG9wLW9wYWNpdHk9IjAiLz48L3JhZGlhbEdyYWRpZW50PjxyYWRpYWxHcmFkaWVudCBpZD0iSiIgY3g9IjAiIGN5PSIwIiByPSIxIiBncmFkaWVudFRyYW5zZm9ybT0ibWF0cml4KDIuMTEyNTE1NzI4NTI5MTg0ZS0xNCwtMzQ1LDg3Ny43NzQsNS4zNzQ4MTU1OTczNzM4NDQ0ZS0xNCwzMjcuODE2LDgxNS42OTUpIiB4bGluazpocmVmPSIjUCI+PHN0b3Agc3RvcC1jb2xvcj0iI2MxM2ZmZiIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzFjMjMxYiIgc3RvcC1vcGFjaXR5PSIwIi8+PHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjYzAwZGZmIiBzdG9wLW9wYWNpdHk9IjAiLz48L3JhZGlhbEdyYWRpZW50PjxyYWRpYWxHcmFkaWVudCBpZD0iSyIgY3g9IjAiIGN5PSIwIiByPSIxIiBncmFkaWVudFRyYW5zZm9ybT0ibWF0cml4KDI2Ny45OTk1MzcyNzMzNzEyLC0yLjAwMDAxNzU2NDY1ODAxNjUsOC41NzIwOTAxOTIzMTM1MjMsMTE0OC42NDgwMTQ2OTgwMzQsNjQuMzE2NCwzODQuMTk1KSIgeGxpbms6aHJlZj0iI1AiPjxzdG9wIHN0b3AtY29sb3I9IiNiOTQ2ZmYiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiMxYzIzMWIiIHN0b3Atb3BhY2l0eT0iMCIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzg2MGRmZiIgc3RvcC1vcGFjaXR5PSIwIi8+PC9yYWRpYWxHcmFkaWVudD48cmFkaWFsR3JhZGllbnQgaWQ9IkwiIGN4PSIwIiBjeT0iMCIgcj0iMSIgZ3JhZGllbnRUcmFuc2Zvcm09Im1hdHJpeCgtMjQyLDIuOTYzNjQ1MjUzOTM2NTk1ZS0xNCwtMS41NjQ0MDA1NjA2MzQ4MDM2ZS0xMywtMTI3Ny40Myw1NzQuMzE2LDM4Mi4xOTUpIiB4bGluazpocmVmPSIjUCI+PHN0b3Agc3RvcC1jb2xvcj0iI2RkMGZmZiIgc3RvcC1vcGFjaXR5PSIuOTEiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiMxYzIzMWIiIHN0b3Atb3BhY2l0eT0iMCIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iI2EzMGRmZiIgc3RvcC1vcGFjaXR5PSIwIi8+PC9yYWRpYWxHcmFkaWVudD48cGF0aCBpZD0iTSIgZD0iTTQxMy4zODcgNzYuMTk1SDIzOS4yNDZjLTIuMjY0IDkuNzQxLTEwLjk5OSAxNy0yMS40MyAxN2gtMzljLTEwLjQzIDAtMTkuMTY1LTcuMjU5LTIxLjQyOS0xN2gtNDMuOTc5bC0zMy41OTIgMzMuNTkydjY4MS40MDhoNDUzLjUwMWwzNi40OTktMzYuNXYtNjQxbC0zNy41LTM3LjVoLTM3LjA3Yy0yLjI2NCA5Ljc0MS0xMC45OTkgMTctMjEuNDMgMTdoLTM5Yy0xMC40MyAwLTE5LjE2NS03LjI1OS0yMS40MjktMTd6Ii8+PHBhdGggaWQ9Ik4iIGQ9Ik0yMTcuODE2IDk0LjE5NWMxMC42MjggMCAxOS41Ny03LjIwNyAyMi4yMS0xN2gxNzIuNTgxYzIuNjQgOS43OTMgMTEuNTgyIDE3IDIyLjIwOSAxN2gzOWMxMC42MjggMCAxOS41Ny03LjIwNyAyMi4yMS0xN2gzNS44NzZsMzYuOTE0IDM2LjkxNXY2NDAuMTcxbC0zNS45MTQgMzUuOTE0SDgwLjgxNlYxMTAuMjAxbDMzLjAwNi0zMy4wMDZoNDIuNzg1YzIuNjQgOS43OTMgMTEuNTgyIDE3IDIyLjIwOSAxN2gzOXoiLz48cGF0aCBpZD0iTyIgZD0iTTQ5OSAzNTF2MTJtMCAwdjEybTAtMTJoLTEybTEyIDBoMTJtLTEyIDdhNyA3IDAgMSAxIDAtMTQgNyA3IDAgMSAxIDAgMTR6Ii8+PGxpbmVhckdyYWRpZW50IGlkPSJQIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIvPjwvZGVmcz48L3N2Zz4=",
        "attributes":
        [
          {
            "trait_type": "Quest ID",
            "value": questId.toString()
          },
          {
            "trait_type": "Token ID",
            "value": tokenId.toString()
          },
          {
            "trait_type": "Total Participants",
            "value": totalParticipants.toString()
          },
          {
            "trait_type": "Claimed",
            "value": claimed.toString()
          },
          {
            "trait_type": "Reward Amount",
            "value": "0.1"
          },
          {
            "trait_type": "Reward Address",
            "value": wrappedEthAddress.toString().toLowerCase()
          }
        ]
      }

      expect(JSON.parse(metadata)).to.eql(expectedMetada);
    })
  })
})
