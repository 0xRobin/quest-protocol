import {expect} from 'chai'
import { Contract } from 'ethers';
import {ethers, upgrades} from 'hardhat'

describe('ReceiptRenderer Contract', async () => {
  let ReceiptRenderer: Contract,
  deployedReceiptRenderer: Contract

  const wrappedEthAddress = "0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"
  const tokenId = 100
  const questId = "questid123"
  const totalParticipants = 500
  const claimed = true
  const rewardAmount = 1000

  beforeEach(async () => {
    ReceiptRenderer = await ethers.getContractFactory('ReceiptRenderer')

    deployedReceiptRenderer = await ReceiptRenderer.deploy()
    await deployedReceiptRenderer.deployed()
  })

  describe('generateTextFields', () => {
    it('generates the correct text fields', async () => {
      let textFields = await deployedReceiptRenderer.generateTextFields(claimed, questId, rewardAmount, wrappedEthAddress);
      expect(textFields).to.equal('<g filter="url(#E)" class="G"><text fill="#0f0f16" xml:space="preserve" style="white-space:pre" font-size="26" font-weight="bold" letter-spacing="0.07em"><tspan x="450" y="750" class="H">CLAIMED</tspan></text></g><g filter="url(#F)" class="F G"><text xml:space="preserve" style="white-space:pre" font-size="26" letter-spacing="0.07em"><tspan x="200" y="750" class="H">#questid123</tspan></text></g><g filter="url(#G)" class="F G H L"><text font-size="26" letter-spacing="0em" x="50%" y="615"><tspan>RabbitHole</tspan></text></g><g filter="url(#H)" class="F G H L"><text font-size="39.758" letter-spacing="0.05em" x="50%" y="365">0.000000000000001 WETH</text></g>')
    })
  })

  describe('humanRewardAmountAndSymbol', () => {
    it('generates the reward amount and symbol text', async () => {
      let rewardAmountText = await deployedReceiptRenderer.humanRewardAmountAndSymbol(ethers.BigNumber.from("100000000000000000"), wrappedEthAddress);
      expect(rewardAmountText).to.equal("0.1 WETH")
    })
  })

  describe('generateTokenURI', () => {
    it('has the correct metadata', async () => {
      let base64encoded = await deployedReceiptRenderer.generateTokenURI(tokenId, questId, totalParticipants, claimed, rewardAmount, wrappedEthAddress);

      let buff = Buffer.from(base64encoded.replace("data:application/json;base64,", ""), 'base64');
      let metadata = buff.toString('ascii');

      let expectedMetada = {
        "name": "RabbitHole.gg Receipt #100",
        "description": "RabbitHole.gg Receipts are used to claim rewards from completed quests.",
        "image": "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iNjQ4IiBoZWlnaHQ9Ijg4OSIgZmlsbD0ibm9uZSIgeG1sbnM6dj0iaHR0cHM6Ly92ZWN0YS5pby9uYW5vIj48c3R5bGU+PCFbQ0RBVEFbLkJ7Y29sb3ItaW50ZXJwb2xhdGlvbi1maWx0ZXJzOnNSR0J9LkN7Zmxvb2Qtb3BhY2l0eTowfS5Ee2ZpbGwtcnVsZTpldmVub2RkfS5Fe2ZpbGwtb3BhY2l0eTouNX0uRntmaWxsOiNkYWUwZmZ9Lkd7Zm9udC1mYW1pbHk6QXJpYWx9Lkh7dGV4dC1hbmNob3I6bWlkZGxlfS5Je3N0cm9rZTojYWQ4NmZmfS5Ke3N0cm9rZS13aWR0aDoyfS5Le3NoYXBlLXJlbmRlcmluZzpjcmlzcEVkZ2VzfS5Me2RvbWluYW50LWJhc2VsaW5lOm1pZGRsZX1dXT48L3N0eWxlPjxnIGZpbHRlcj0idXJsKCNCKSI+PHBhdGggZD0iTTkxLjczMSA0NC4xOTVjLTI1Ljk1NyAwLTQ3IDIxLjA0My00NyA0N3YxMTRjMCAyNS45NTggMjEuMDQzIDQ3IDQ3IDQ3SDIyMC4yM3YzODRIOTEuNzMxYy0yNS45NTcgMC00NyAyMS4wNDMtNDcgNDd2MTE0YzAgMjUuOTU4IDIxLjA0MyA0NyA0NyA0N2g0NjVjMjUuOTU4IDAgNDctMjEuMDQyIDQ3LTQ3di0xMTRjMC0yNS45NTctMjEuMDQyLTQ3LTQ3LTQ3aC0xMjguNXYtMzg0aDEyOC41YzI1Ljk1OCAwIDQ3LTIxLjA0MiA0Ny00N3YtMTE0YzAtMjUuOTU3LTIxLjA0Mi00Ny00Ny00N0g5MS43MzF6IiBmaWxsPSIjMGYwZjE2IiBjbGFzcz0iRCIvPjxwYXRoIGQ9Ik0yMjAuNzMgMjUyLjE5NXYtLjVoLS41SDkxLjczMWMtMjUuNjgxIDAtNDYuNS0yMC44MTgtNDYuNS00Ni41di0xMTRjMC0yNS42ODEgMjAuODE5LTQ2LjUgNDYuNS00Ni41aDQ2NWMyNS42ODIgMCA0Ni41IDIwLjgxOSA0Ni41IDQ2LjV2MTE0YzAgMjUuNjgyLTIwLjgxOCA0Ni41LTQ2LjUgNDYuNWgtMTI4LjUtLjV2LjUgMzg0IC41aC41IDEyOC41YzI1LjY4MiAwIDQ2LjUgMjAuODE5IDQ2LjUgNDYuNXYxMTRjMCAyNS42ODItMjAuODE4IDQ2LjUtNDYuNSA0Ni41SDkxLjczMWMtMjUuNjgxIDAtNDYuNS0yMC44MTgtNDYuNS00Ni41di0xMTRjMC0yNS42ODEgMjAuODE5LTQ2LjUgNDYuNS00Ni41SDIyMC4yM2guNXYtLjUtMzg0eiIgc3Ryb2tlPSIjMjMyODU0Ii8+PC9nPjxtYXNrIGlkPSJBIiBmaWxsPSIjZmZmIj48cGF0aCBkPSJNNDQuNzMxIDkxLjE5NWMwLTI1Ljk1NyAyMS4wNDMtNDcgNDctNDdoNDY1YzI1Ljk1OCAwIDQ3IDIxLjA0MyA0NyA0N3YxMTRjMCAyMS40NDgtMTQuMzY1IDM5LjU0LTM0IDQ1LjE3OXYzODcuNjQyYzE5LjYzNSA1LjY0IDM0IDIzLjczMiAzNCA0NS4xNzl2MTE0YzAgMjUuOTU4LTIxLjA0MiA0Ny00NyA0N0g5MS43MzFjLTI1Ljk1NyAwLTQ3LTIxLjA0Mi00Ny00N3YtMTE0YzAtMjEuODEgMTQuODU2LTQwLjE1IDM1LTQ1LjQ1NFYyNTAuNjVjLTIwLjE0NS01LjMwNC0zNS0yMy42NDUtMzUtNDUuNDU1di0xMTR6IiBjbGFzcz0iRCIvPjwvbWFzaz48cGF0aCBkPSJNNTY5LjczIDI1MC4zNzRsLS4yNzYtLjk2MS0uNzI0LjIwOHYuNzUzaDF6bTAgMzg3LjY0MmgtMXYuNzU0bC43MjQuMjA3LjI3Ni0uOTYxem0tNDg5Ljk5OS0uMjc1bC4yNTUuOTY3Ljc0NS0uMTk2di0uNzcxaC0xem0wLTM4Ny4wOTFoMXYtLjc3MWwtLjc0NS0uMTk3LS4yNTUuOTY4em0xMi0yMDcuNDU1Yy0yNi41MSAwLTQ4IDIxLjQ5LTQ4IDQ4aDJjMC0yNS40MDUgMjAuNTk1LTQ2IDQ2LTQ2di0yem00NjUgMEg5MS43MzF2Mmg0NjV2LTJ6bTQ4IDQ4YzAtMjYuNTEtMjEuNDktNDgtNDgtNDh2MmMyNS40MDYgMCA0NiAyMC41OTUgNDYgNDZoMnptMCAxMTR2LTExNGgtMnYxMTRoMnptLTM0LjcyMyA0Ni4xNGMyMC4wNTEtNS43NTkgMzQuNzIzLTI0LjIzNCAzNC43MjMtNDYuMTRoLTJjMCAyMC45OS0xNC4wNTkgMzguNjk5LTMzLjI3NiA0NC4yMThsLjU1MyAxLjkyMnptLjcyMyAzODYuNjgxVjI1MC4zNzRoLTJ2Mzg3LjY0Mmgyem0zNCA0NS4xNzljMC0yMS45MDUtMTQuNjcyLTQwLjM4MS0zNC43MjMtNDYuMTRsLS41NTMgMS45MjJjMTkuMjE3IDUuNTIgMzMuMjc2IDIzLjIyOSAzMy4yNzYgNDQuMjE4aDJ6bTAgMTE0di0xMTRoLTJ2MTE0aDJ6bS00OCA0OGMyNi41MSAwIDQ4LTIxLjQ5IDQ4LTQ4aC0yYzAgMjUuNDA1LTIwLjU5NCA0Ni00NiA0NnYyem0tNDY0Ljk5OSAwaDQ2NXYtMkg5MS43MzF2MnptLTQ4LTQ4YzAgMjYuNTEgMjEuNDkgNDggNDggNDh2LTJjLTI1LjQwNSAwLTQ2LTIwLjU5NS00Ni00NmgtMnptMC0xMTR2MTE0aDJ2LTExNGgtMnptMzUuNzQ1LTQ2LjQyMWMtMjAuNTczIDUuNDE3LTM1Ljc0NSAyNC4xNDYtMzUuNzQ1IDQ2LjQyMWgyYzAtMjEuMzQ0IDE0LjUzOS0zOS4yOTYgMzQuMjU1LTQ0LjQ4N2wtLjUwOS0xLjkzNHptLS43NDUtMzg2LjEyNHYzODcuMDkxaDJWMjUwLjY1aC0yem0tMzUtNDUuNDU1YzAgMjIuMjc2IDE1LjE3MyA0MS4wMDUgMzUuNzQ1IDQ2LjQyMmwuNTA5LTEuOTM1Yy0xOS43MTYtNS4xOTEtMzQuMjU1LTIzLjE0Mi0zNC4yNTUtNDQuNDg3aC0yem0wLTExNHYxMTRoMnYtMTE0aC0yeiIgZmlsbD0iIzIzMjg1NCIgbWFzaz0idXJsKCNBKSIvPjxnIGZpbHRlcj0idXJsKCNDKSIgY2xhc3M9IkQgSyI+PHVzZSB4bGluazpocmVmPSIjTiIgZmlsbD0iIzAwMCIgZmlsbC1vcGFjaXR5PSIuMDEiLz48L2c+PHVzZSB4bGluazpocmVmPSIjTiIgZmlsbD0iIzBjMGIwZiIgZmlsbC1vcGFjaXR5PSIuMjYiIGNsYXNzPSJEIi8+PGcgc3R5bGU9Im1peC1ibGVuZC1tb2RlOmNvbG9yLWRvZGdlIiBmaWx0ZXI9InVybCgjRCkiIGNsYXNzPSJEIEsiPjx1c2UgeGxpbms6aHJlZj0iI04iIGZpbGw9InVybCgjSSkiIGZpbGwtb3BhY2l0eT0iLjk5Ii8+PC9nPjx1c2UgeGxpbms6aHJlZj0iI08iIGZpbGw9InVybCgjSikiIHN0eWxlPSJtaXgtYmxlbmQtbW9kZTpjb2xvci1kb2RnZSIgY2xhc3M9IkUiLz48dXNlIHhsaW5rOmhyZWY9IiNPIiBmaWxsPSJ1cmwoI0spIiBzdHlsZT0ibWl4LWJsZW5kLW1vZGU6Y29sb3ItZG9kZ2UiIGNsYXNzPSJFIi8+PHVzZSB4bGluazpocmVmPSIjTyIgZmlsbD0idXJsKCNMKSIgc3R5bGU9Im1peC1ibGVuZC1tb2RlOmNvbG9yLWRvZGdlIiBjbGFzcz0iRSIvPjx1c2UgeGxpbms6aHJlZj0iI08iIGZpbGw9InVybCgjTSkiIHN0eWxlPSJtaXgtYmxlbmQtbW9kZTpjb2xvci1kb2RnZSIgY2xhc3M9IkUiLz48dXNlIHhsaW5rOmhyZWY9IiNPIiBjbGFzcz0iSSBKIi8+PHBhdGggZD0iTTMyNC4yNyA2OTUuMTk1aDI0NXY1OC41bC0zNy41IDM3LjVoLTIwNy41di05NnoiIGZpbGw9IiNhZDg2ZmYiLz48cGF0aCBkPSJNMzI1LjIzMSAzMTUuMDA5bC0uMDAxLTIzNi44MDJtLTcuNSAyMzYuMjY1Vjk1Ljg5MmwtMTguNS0xOC42OTdtMzMuNSAyMzcuMjc3Vjk1Ljg5MmwxOC41LTE4LjY5N20tNDAuNSAyMzcuNTQ1Vjk5LjQzbC0yMi0yMi4yMzRtNTIgMjM3LjI3N1Y5OS40M2wyMi0yMi4yMzRtLTM2LjUgMzMxLjY2NmwtLjAwMSAxNzAuNTY1bTcuNTAxLTE3MC41NjV2MTUyLjg4bDE4LjUgMTguNjk3bS0zMy41LTE3MS41Nzd2MTUyLjg4bC0xOC41IDE4LjY5N200MC41LTE3MS4yNDJ2MTQ5LjAwN2wyMiAyMi4yMzVtLTUyLTE3MS43NzV2MTQ5LjU0bC0yMiAyMi4yMzVtLTY2LjY4My0yNjYuMjQzSDQyMi42N2wyOS42IDQ3LjUtMjkuNiA0Ny41SDIyMi4wNDdsLTI4Ljc3Ny00Ny41IDI4Ljc3Ny00Ny41em0uMjIzIDI5Ny41YzAtMTcuMzk3IDE0LjEwMy0zMS41IDMxLjUtMzEuNWgxNDBjMTcuMzk3IDAgMzEuNSAxNC4xMDMgMzEuNSAzMS41cy0xNC4xMDMgMzEuNS0zMS41IDMxLjVoLTE0MGMtMTcuMzk3IDAtMzEuNS0xNC4xMDMtMzEuNS0zMS41em0xMDIgODMuNDk5djk1bS0yNDUtOTZoNDg4IiBjbGFzcz0iSSBKIi8+PHBhdGggZD0iTTUwOC4wMjIgMTc4LjM0YzEwLjgwMy00LjMyMyAxOC40NS0xNS4wMjkgMTguNDUtMjcuNTUgMC0xNi4zNDUtMTMuMDI5LTI5LjU5NS0yOS4xMDEtMjkuNTk1cy0yOS4xMDEgMTMuMjUtMjkuMTAxIDI5LjU5NWMwIDEwLjM4NSA1LjI1OSAxOS41MiAxMy4yMTcgMjQuODAyLjU2Ni0xLjAyIDEuNjEyLTEuNzA1IDIuODA5LTEuNzA1LjI2NSAwIC40ODgtLjI0Ny40MjItLjUwNGEyMC40NyAyMC40NyAwIDAgMS0uNjQ0LTUuMTE1YzAtMTAuNjUyIDguMTA1LTE5LjI4NyAxOC4xMDQtMTkuMjg3LjY4NyAwIDEuMjkzLS40NjMgMS41MjItMS4xMTFsLjA1OC0uMTU4Yy40NzEtMS4yNi0uMzE0LTMuMDQzLTEuNjI1LTMuMzQ1LTYuNy0xLjU0NS0xMi4wMTYtNy4wMjItMTMuNjg4LTE0LjAzNi0uMTkyLS44MDUuNzE0LTEuMzQxIDEuMzczLS44MzlsMjYuNDE2IDIwLjA5N2MuMjg3LjIxOC40MjEuNTgzLjM1OC45MzktLjE4MSAxLjAyMS0uMjc2IDIuMDc1LS4yNzYgMy4xNTIgMCAxLjMzNC4xNDYgMi42MzMuNDIgMy44NzguMDc5LjM2MS0uMDQzLjc0Mi0uMzQ4Ljk1MWE4LjI0IDguMjQgMCAwIDEtNC42NjIgMS40NDdjLTEuMzk3IDAtMi43MTYtLjM1MS0zLjg4LS45NzMtLjM0NC0uMTg0LS43NC0uMjU1LTEuMTE5LS4xNjUtLjY1Mi4xNTUtMS4xMTIuNzM4LTEuMTEyIDEuNDA4djEyLjE2OWMwIC41MTYtLjQxOC45MzQtLjkzNC45MzRoLTEuNTA2Yy0uNTA0IDAtLjkxMi0uNC0uOTc4LS44OTktLjU2LTQuMjI5LTMuOTczLTcuNDgzLTguMTAxLTcuNDgzLS4yNjIgMC0uNTIxLjAxMy0uNzc3LjAzOS0uMzA0LjAzLS41MjQuMjk0LS41MjQuNiAwIC4zMzUuMjY0LjYwNy41OTYuNjUzIDMuMzk5LjQ3MSA2LjAyNCAzLjU1MyA2LjAyNCA3LjI4NWE3LjgzIDcuODMgMCAwIDEtLjEzNyAxLjQ2NGMtLjEwMS41MjcuMjc4IDEuMDU5LjgxNSAxLjA1OWguNzYyYS4wMi4wMiAwIDAgMSAuMDIuMDIuMDIuMDIgMCAwIDAgLjAyLjAyaDUuODk0Yy4wNjUgMCAuMTI4LjAyNS4xNzQuMDcxaDBhMTUuNTIgMTUuNTIgMCAwIDEgLjUwOS41MmMuMzUuMzguNDkyLjkxNS41NSAxLjY2MnptLTI3LjQxOS0zMS42NWMtLjQ4OC0uMzg5LS4xOTMtMS4xMjYuNDMxLTEuMTI2aDE2LjYyNmMuNjI0IDAgLjkxOS43MzcuNDMxIDEuMTI2LTIuNDM2IDEuOTQtNS40NjMgMy4wODktOC43NDQgMy4wODlzLTYuMzA5LTEuMTQ5LTguNzQ0LTMuMDg5em0zMS41IDUuMzAzYzAgLjkyMi0uNzA1IDEuNjY5LTEuNTc1IDEuNjY5cy0xLjU3NS0uNzQ3LTEuNTc1LTEuNjY5LjcwNS0xLjY2OSAxLjU3NS0xLjY2OSAxLjU3NS43NDggMS41NzUgMS42Njl6IiBjbGFzcz0iRCBGIi8+PGcgZmlsdGVyPSJ1cmwoI0UpIiBjbGFzcz0iRyI+PHRleHQgZmlsbD0iIzBmMGYxNiIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIgc3R5bGU9IndoaXRlLXNwYWNlOnByZSIgZm9udC1zaXplPSIyNiIgZm9udC13ZWlnaHQ9ImJvbGQiIGxldHRlci1zcGFjaW5nPSIwLjA3ZW0iPjx0c3BhbiB4PSI0NTAiIHk9Ijc1MCIgY2xhc3M9IkgiPkNMQUlNRUQ8L3RzcGFuPjwvdGV4dD48L2c+PGcgZmlsdGVyPSJ1cmwoI0YpIiBjbGFzcz0iRiBHIj48dGV4dCB4bWw6c3BhY2U9InByZXNlcnZlIiBzdHlsZT0id2hpdGUtc3BhY2U6cHJlIiBmb250LXNpemU9IjI2IiBsZXR0ZXItc3BhY2luZz0iMC4wN2VtIj48dHNwYW4geD0iMjAwIiB5PSI3NTAiIGNsYXNzPSJIIj4jcXVlc3RpZDEyMzwvdHNwYW4+PC90ZXh0PjwvZz48ZyBmaWx0ZXI9InVybCgjRykiIGNsYXNzPSJGIEcgSCBMIj48dGV4dCBmb250LXNpemU9IjI2IiBsZXR0ZXItc3BhY2luZz0iMGVtIiB4PSI1MCUiIHk9IjYxNSI+PHRzcGFuPlJhYmJpdEhvbGU8L3RzcGFuPjwvdGV4dD48L2c+PGcgZmlsdGVyPSJ1cmwoI0gpIiBjbGFzcz0iRiBHIEggTCI+PHRleHQgZm9udC1zaXplPSIzOS43NTgiIGxldHRlci1zcGFjaW5nPSIwLjA1ZW0iIHg9IjUwJSIgeT0iMzY1Ij4wLjAwMDAwMDAwMDAwMDAwMSBXRVRIPC90ZXh0PjwvZz48ZyBjbGFzcz0iSSBKIj48dXNlIHhsaW5rOmhyZWY9IiNQIi8+PHVzZSB4bGluazpocmVmPSIjUCIgeD0iLTM1MyIvPjx1c2UgeGxpbms6aHJlZj0iI1AiIHk9IjI1NiIvPjx1c2UgeGxpbms6aHJlZj0iI1AiIHg9Ii0zNTMiIHk9IjI1NiIvPjwvZz48ZGVmcz48ZmlsdGVyIGlkPSJCIiB4PSIuNzMiIHk9Ii4xOTUiIHdpZHRoPSI2NDciIGhlaWdodD0iODg4IiBmaWx0ZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIGNsYXNzPSJCIj48ZmVGbG9vZCBjbGFzcz0iQyIvPjxmZUJsZW5kIGluPSJTb3VyY2VHcmFwaGljIi8+PGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iMjIiLz48L2ZpbHRlcj48ZmlsdGVyIGlkPSJDIiB4PSIxMy44MTYiIHk9IjEwLjE5NSIgd2lkdGg9IjYyMiIgaGVpZ2h0PSI4NDciIGZpbHRlclVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgY2xhc3M9IkIiPjxmZUZsb29kIHJlc3VsdD0iQSIgY2xhc3M9IkMiLz48ZmVDb2xvck1hdHJpeCBpbj0iU291cmNlQWxwaGEiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMTI3IDAiIHJlc3VsdD0iQiIvPjxmZU9mZnNldC8+PGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iMSIvPjxmZUNvbXBvc2l0ZSBpbjI9IkIiIG9wZXJhdG9yPSJvdXQiLz48ZmVDb2xvck1hdHJpeCB2YWx1ZXM9IjAgMCAwIDAgMC43NTYgMCAwIDAgMCAwLjIzNzUgMCAwIDAgMCAxIDAgMCAwIDEgMCIvPjxmZUJsZW5kIGluMj0iQSIgcmVzdWx0PSJDIi8+PGZlQ29sb3JNYXRyaXggaW49IlNvdXJjZUFscGhhIiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDEyNyAwIiByZXN1bHQ9IkIiLz48ZmVPZmZzZXQvPjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjMzIi8+PGZlQ29tcG9zaXRlIGluMj0iQiIgb3BlcmF0b3I9Im91dCIvPjxmZUNvbG9yTWF0cml4IHZhbHVlcz0iMCAwIDAgMCAwLjYwOTUgMCAwIDAgMCAwLjExMjUgMCAwIDAgMCAxIDAgMCAwIDAuODMgMCIvPjxmZUJsZW5kIGluMj0iQyIvPjxmZUJsZW5kIGluPSJTb3VyY2VHcmFwaGljIiByZXN1bHQ9IkUiLz48ZmVDb2xvck1hdHJpeCBpbj0iU291cmNlQWxwaGEiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMTI3IDAiIHJlc3VsdD0iQiIvPjxmZU9mZnNldC8+PGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iMSIvPjxmZUNvbXBvc2l0ZSBpbjI9IkIiIG9wZXJhdG9yPSJhcml0aG1ldGljIiBrMj0iLTEiIGszPSIxIi8+PGZlQ29sb3JNYXRyaXggdmFsdWVzPSIwIDAgMCAwIDAuNjMgMCAwIDAgMCAwLjUzNzUgMCAwIDAgMCAxIDAgMCAwIDEgMCIvPjxmZUJsZW5kIGluMj0iRSIvPjwvZmlsdGVyPjxmaWx0ZXIgaWQ9IkQiIHg9Ijc1LjgxNiIgeT0iNzYuMTk1IiB3aWR0aD0iNDk4IiBoZWlnaHQ9IjcyMyIgZmlsdGVyVW5pdHM9InVzZXJTcGFjZU9uVXNlIiBjbGFzcz0iQiI+PGZlRmxvb2QgcmVzdWx0PSJBIiBjbGFzcz0iQyIvPjxmZUNvbG9yTWF0cml4IGluPSJTb3VyY2VBbHBoYSIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAxMjcgMCIgcmVzdWx0PSJCIi8+PGZlT2Zmc2V0IGR5PSI0Ii8+PGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iMiIvPjxmZUNvbXBvc2l0ZSBpbjI9IkIiIG9wZXJhdG9yPSJvdXQiLz48ZmVDb2xvck1hdHJpeCB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMjUgMCIvPjxmZUJsZW5kIGluMj0iQSIvPjxmZUJsZW5kIGluPSJTb3VyY2VHcmFwaGljIi8+PC9maWx0ZXI+PGZpbHRlciBpZD0iRSIgeD0iMzA5LjYwOCIgeT0iNjc1LjU4NCIgd2lkdGg9IjI3NC45MjEiIGhlaWdodD0iMTM2LjYxMSIgZmlsdGVyVW5pdHM9InVzZXJTcGFjZU9uVXNlIiBjbGFzcz0iQiI+PGZlRmxvb2QgcmVzdWx0PSJBIiBjbGFzcz0iQyIvPjxmZUNvbG9yTWF0cml4IGluPSJTb3VyY2VBbHBoYSIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAxMjcgMCIgcmVzdWx0PSJCIi8+PGZlT2Zmc2V0Lz48ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIxLjUiLz48ZmVDb21wb3NpdGUgaW4yPSJCIiBvcGVyYXRvcj0ib3V0Ii8+PGZlQ29sb3JNYXRyaXggdmFsdWVzPSIwIDAgMCAwIDAuOTY2ODY3IDAgMCAwIDAgMC41ODU4MzMgMCAwIDAgMCAxIDAgMCAwIDAuODcgMCIvPjxmZUJsZW5kIGluMj0iQSIgcmVzdWx0PSJDIi8+PGZlQ29sb3JNYXRyaXggaW49IlNvdXJjZUFscGhhIiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDEyNyAwIiByZXN1bHQ9IkIiLz48ZmVPZmZzZXQvPjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjI5LjUiLz48ZmVDb21wb3NpdGUgaW4yPSJCIiBvcGVyYXRvcj0ib3V0Ii8+PGZlQ29sb3JNYXRyaXggdmFsdWVzPSIwIDAgMCAwIDAuNjI0MTY3IDAgMCAwIDAgMC4xNDU4MzMgMCAwIDAgMCAxIDAgMCAwIDAuOTEgMCIvPjxmZUJsZW5kIGluMj0iQyIvPjxmZUJsZW5kIGluPSJTb3VyY2VHcmFwaGljIi8+PC9maWx0ZXI+PGZpbHRlciBpZD0iRiIgeD0iMTAxLjUzNiIgeT0iNjcwLjI2NyIgd2lkdGg9IjE5Ni4xMDciIGhlaWdodD0iMTM3LjI0NiIgZmlsdGVyVW5pdHM9InVzZXJTcGFjZU9uVXNlIiBjbGFzcz0iQiI+PGZlRmxvb2QgcmVzdWx0PSJBIiBjbGFzcz0iQyIvPjxmZUNvbG9yTWF0cml4IGluPSJTb3VyY2VBbHBoYSIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAxMjcgMCIgcmVzdWx0PSJCIi8+PGZlT2Zmc2V0Lz48ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIxLjUiLz48ZmVDb21wb3NpdGUgaW4yPSJCIiBvcGVyYXRvcj0ib3V0Ii8+PGZlQ29sb3JNYXRyaXggdmFsdWVzPSIwIDAgMCAwIDAuOTY2ODY3IDAgMCAwIDAgMC41ODU4MzMgMCAwIDAgMCAxIDAgMCAwIDAuODcgMCIvPjxmZUJsZW5kIGluMj0iQSIgcmVzdWx0PSJDIi8+PGZlQ29sb3JNYXRyaXggaW49IlNvdXJjZUFscGhhIiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDEyNyAwIiByZXN1bHQ9IkIiLz48ZmVPZmZzZXQvPjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjI5LjUiLz48ZmVDb21wb3NpdGUgaW4yPSJCIiBvcGVyYXRvcj0ib3V0Ii8+PGZlQ29sb3JNYXRyaXggdmFsdWVzPSIwIDAgMCAwIDAuNjI0MTY3IDAgMCAwIDAgMC4xNDU4MzMgMCAwIDAgMCAxIDAgMCAwIDAuOTEgMCIvPjxmZUJsZW5kIGluMj0iQyIvPjxmZUJsZW5kIGluPSJTb3VyY2VHcmFwaGljIi8+PC9maWx0ZXI+PGZpbHRlciBpZD0iRyIgeD0iMjAzLjE2NiIgeT0iNTQzLjM4OSIgd2lkdGg9IjI0My42MiIgaGVpZ2h0PSIxMzYuOTE2IiBmaWx0ZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIGNsYXNzPSJCIj48ZmVGbG9vZCByZXN1bHQ9IkEiIGNsYXNzPSJDIi8+PGZlQ29sb3JNYXRyaXggaW49IlNvdXJjZUFscGhhIiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDEyNyAwIiByZXN1bHQ9IkIiLz48ZmVPZmZzZXQvPjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjEuNSIvPjxmZUNvbXBvc2l0ZSBpbjI9IkIiIG9wZXJhdG9yPSJvdXQiLz48ZmVDb2xvck1hdHJpeCB2YWx1ZXM9IjAgMCAwIDAgMC45NjY4NjcgMCAwIDAgMCAwLjU4NTgzMyAwIDAgMCAwIDEgMCAwIDAgMC44NyAwIi8+PGZlQmxlbmQgaW4yPSJBIiByZXN1bHQ9IkMiLz48ZmVDb2xvck1hdHJpeCBpbj0iU291cmNlQWxwaGEiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMTI3IDAiIHJlc3VsdD0iQiIvPjxmZU9mZnNldC8+PGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iMjkuNSIvPjxmZUNvbXBvc2l0ZSBpbjI9IkIiIG9wZXJhdG9yPSJvdXQiLz48ZmVDb2xvck1hdHJpeCB2YWx1ZXM9IjAgMCAwIDAgMC42MjQxNjcgMCAwIDAgMCAwLjE0NTgzMyAwIDAgMCAwIDEgMCAwIDAgMC45MSAwIi8+PGZlQmxlbmQgaW4yPSJDIi8+PGZlQmxlbmQgaW49IlNvdXJjZUdyYXBoaWMiLz48L2ZpbHRlcj48ZmlsdGVyIGlkPSJIIiB4PSIxOTYuODc2IiB5PSIyOTAuNjE5IiB3aWR0aD0iMjQ3LjciIGhlaWdodD0iMTQ3LjA2MiIgZmlsdGVyVW5pdHM9InVzZXJTcGFjZU9uVXNlIiBjbGFzcz0iQiI+PGZlRmxvb2QgcmVzdWx0PSJBIiBjbGFzcz0iQyIvPjxmZUNvbG9yTWF0cml4IGluPSJTb3VyY2VBbHBoYSIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAxMjcgMCIgcmVzdWx0PSJCIi8+PGZlT2Zmc2V0Lz48ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIxLjUiLz48ZmVDb21wb3NpdGUgaW4yPSJCIiBvcGVyYXRvcj0ib3V0Ii8+PGZlQ29sb3JNYXRyaXggdmFsdWVzPSIwIDAgMCAwIDAuOTY2ODY3IDAgMCAwIDAgMC41ODU4MzMgMCAwIDAgMCAxIDAgMCAwIDAuODcgMCIvPjxmZUJsZW5kIGluMj0iQSIgcmVzdWx0PSJDIi8+PGZlQ29sb3JNYXRyaXggaW49IlNvdXJjZUFscGhhIiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDEyNyAwIiByZXN1bHQ9IkIiLz48ZmVPZmZzZXQvPjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjI5LjUiLz48ZmVDb21wb3NpdGUgaW4yPSJCIiBvcGVyYXRvcj0ib3V0Ii8+PGZlQ29sb3JNYXRyaXggdmFsdWVzPSIwIDAgMCAwIDAuNjI0MTY3IDAgMCAwIDAgMC4xNDU4MzMgMCAwIDAgMCAxIDAgMCAwIDAuOTEgMCIvPjxmZUJsZW5kIGluMj0iQyIvPjxmZUJsZW5kIGluPSJTb3VyY2VHcmFwaGljIi8+PC9maWx0ZXI+PHJhZGlhbEdyYWRpZW50IGlkPSJJIiBjeD0iMCIgY3k9IjAiIHI9IjEiIGdyYWRpZW50VHJhbnNmb3JtPSJtYXRyaXgoNzg0LjE4NCwwLDAsNzYxLjE3LDMyNS44MTYsMzgwLjE5NSkiIHhsaW5rOmhyZWY9IiNRIj48c3RvcCBvZmZzZXQ9Ii4wMSIgc3RvcC1jb2xvcj0iI2JkMDBmZiIgc3RvcC1vcGFjaXR5PSIuMzkiLz48c3RvcCBvZmZzZXQ9Ii4xMzUiIHN0b3AtY29sb3I9IiNlYzdiZmYiIHN0b3Atb3BhY2l0eT0iLjIyIi8+PHN0b3Agb2Zmc2V0PSIuMjcxIiBzdG9wLWNvbG9yPSIjZjI1YWZmIiBzdG9wLW9wYWNpdHk9Ii40OCIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzAxMDAzOSIgc3RvcC1vcGFjaXR5PSIuNjkiLz48L3JhZGlhbEdyYWRpZW50PjxyYWRpYWxHcmFkaWVudCBpZD0iSiIgY3g9IjAiIGN5PSIwIiByPSIxIiBncmFkaWVudFRyYW5zZm9ybT0idHJhbnNsYXRlKDMyMC4zMTYgNTcuMTk1Mykgcm90YXRlKDg4LjYyMzgpIHNjYWxlKDMzMy4wOTYgNTc5Ljc2MSkiIHhsaW5rOmhyZWY9IiNRIj48c3RvcCBzdG9wLWNvbG9yPSIjOGYwMGZmIiBzdG9wLW9wYWNpdHk9Ii41MSIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzFjMjMxYiIgc3RvcC1vcGFjaXR5PSIwIi8+PHN0b3Agb2Zmc2V0PSIxIiBzdG9wLW9wYWNpdHk9IjAiLz48L3JhZGlhbEdyYWRpZW50PjxyYWRpYWxHcmFkaWVudCBpZD0iSyIgY3g9IjAiIGN5PSIwIiByPSIxIiBncmFkaWVudFRyYW5zZm9ybT0ibWF0cml4KDIuMTEyNTE1NzI4NTI5MTg0ZS0xNCwtMzQ1LDg3Ny43NzQsNS4zNzQ4MTU1OTczNzM4NDQ0ZS0xNCwzMjcuODE2LDgxNS42OTUpIiB4bGluazpocmVmPSIjUSI+PHN0b3Agc3RvcC1jb2xvcj0iI2MxM2ZmZiIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzFjMjMxYiIgc3RvcC1vcGFjaXR5PSIwIi8+PHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjYzAwZGZmIiBzdG9wLW9wYWNpdHk9IjAiLz48L3JhZGlhbEdyYWRpZW50PjxyYWRpYWxHcmFkaWVudCBpZD0iTCIgY3g9IjAiIGN5PSIwIiByPSIxIiBncmFkaWVudFRyYW5zZm9ybT0ibWF0cml4KDI2Ny45OTk1MzcyNzMzNzEyLC0yLjAwMDAxNzU2NDY1ODAxNjUsOC41NzIwOTAxOTIzMTM1MjMsMTE0OC42NDgwMTQ2OTgwMzQsNjQuMzE2NCwzODQuMTk1KSIgeGxpbms6aHJlZj0iI1EiPjxzdG9wIHN0b3AtY29sb3I9IiNiOTQ2ZmYiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiMxYzIzMWIiIHN0b3Atb3BhY2l0eT0iMCIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzg2MGRmZiIgc3RvcC1vcGFjaXR5PSIwIi8+PC9yYWRpYWxHcmFkaWVudD48cmFkaWFsR3JhZGllbnQgaWQ9Ik0iIGN4PSIwIiBjeT0iMCIgcj0iMSIgZ3JhZGllbnRUcmFuc2Zvcm09Im1hdHJpeCgtMjQyLDIuOTYzNjQ1MjUzOTM2NTk1ZS0xNCwtMS41NjQ0MDA1NjA2MzQ4MDM2ZS0xMywtMTI3Ny40Myw1NzQuMzE2LDM4Mi4xOTUpIiB4bGluazpocmVmPSIjUSI+PHN0b3Agc3RvcC1jb2xvcj0iI2RkMGZmZiIgc3RvcC1vcGFjaXR5PSIuOTEiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiMxYzIzMWIiIHN0b3Atb3BhY2l0eT0iMCIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iI2EzMGRmZiIgc3RvcC1vcGFjaXR5PSIwIi8+PC9yYWRpYWxHcmFkaWVudD48cGF0aCBpZD0iTiIgZD0iTTQxMy4zODcgNzYuMTk1SDIzOS4yNDZjLTIuMjY0IDkuNzQxLTEwLjk5OSAxNy0yMS40MyAxN2gtMzljLTEwLjQzIDAtMTkuMTY1LTcuMjU5LTIxLjQyOS0xN2gtNDMuOTc5bC0zMy41OTIgMzMuNTkydjY4MS40MDhoNDUzLjUwMWwzNi40OTktMzYuNXYtNjQxbC0zNy41LTM3LjVoLTM3LjA3Yy0yLjI2NCA5Ljc0MS0xMC45OTkgMTctMjEuNDMgMTdoLTM5Yy0xMC40MyAwLTE5LjE2NS03LjI1OS0yMS40MjktMTd6Ii8+PHBhdGggaWQ9Ik8iIGQ9Ik0yMTcuODE2IDk0LjE5NWMxMC42MjggMCAxOS41Ny03LjIwNyAyMi4yMS0xN2gxNzIuNTgxYzIuNjQgOS43OTMgMTEuNTgyIDE3IDIyLjIwOSAxN2gzOWMxMC42MjggMCAxOS41Ny03LjIwNyAyMi4yMS0xN2gzNS44NzZsMzYuOTE0IDM2LjkxNXY2NDAuMTcxbC0zNS45MTQgMzUuOTE0SDgwLjgxNlYxMTAuMjAxbDMzLjAwNi0zMy4wMDZoNDIuNzg1YzIuNjQgOS43OTMgMTEuNTgyIDE3IDIyLjIwOSAxN2gzOXoiLz48cGF0aCBpZD0iUCIgZD0iTTQ5OSAzNTF2MTJtMCAwdjEybTAtMTJoLTEybTEyIDBoMTJtLTEyIDdhNyA3IDAgMSAxIDAtMTQgNyA3IDAgMSAxIDAgMTR6Ii8+PGxpbmVhckdyYWRpZW50IGlkPSJRIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIvPjwvZGVmcz48L3N2Zz4=",
        "attributes":
        [
          {
            "trait_type": "Quest ID",
            "value": questId.toString()
          },
          {
            "trait_type": "Token ID",
            "value": tokenId.toString()
          },
          {
            "trait_type": "Total Participants",
            "value": totalParticipants.toString()
          },
          {
            "trait_type": "Claimed",
            "value": claimed.toString()
          },
          {
            "trait_type": "Reward Amount",
            "value": rewardAmount.toString()
          },
          {
            "trait_type": "Reward Address",
            "value": wrappedEthAddress.toString().toLowerCase()
          }
        ]
      }

      expect(JSON.parse(metadata)).to.eql(expectedMetada);
    })
  })
})
